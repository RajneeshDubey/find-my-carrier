import { useEffect } from 'react';

/**
 *  React hook for hijacking the functionality of the 'tab' key. When 'tab' is pressed, focus wil move to the element referenced by the 'ref' param instead of where it naturally would have moved.
 *
 * @example
 *  const MyComponent = () => {
 *    const myRef = useRef(null);
 *
 *    useFocusControl(myRef);
 *
 *    return (
 *      <div>
 *        <button ref={myRef} onClick={() => {}}>
 *          action
 *        </button>
 *      </div>
 *    );
 *  };
 *
 *  // Regardless of where focus was when the component mounted, the next press of the 'tab' key will focus the button in this component.
 *
 * @param {React.RefObject} ref —  The ref to the component that will recieve focus once the 'tab' key is pressed
 * @param {array} conditions — An array containing variables that when changed will rerun the effect.
 * @returns {void}
 */

var useFocusControl = (ref,
/* eslint-disable-next-line @typescript-eslint/no-explicit-any */
conditions = []) => {
  useEffect(() => {
    var _ref$current;

    var canFocus = ref === null || ref === void 0 ? void 0 : (_ref$current = ref.current) === null || _ref$current === void 0 ? void 0 : _ref$current.focus;

    var handleFocusChange = e => {
      e.preventDefault();
      /* istanbul ignore else */

      if (canFocus) {
        var _ref$current2;

        ref === null || ref === void 0 ? void 0 : (_ref$current2 = ref.current) === null || _ref$current2 === void 0 ? void 0 : _ref$current2.focus();
        document.removeEventListener("keydown", handleFocusChange);
      }
    };

    if (canFocus) {
      document.addEventListener("keydown", handleFocusChange);
    }

    return () => {
      document.removeEventListener("keydown", handleFocusChange);
    }; // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [ref, ...conditions]);
};

export { useFocusControl };
